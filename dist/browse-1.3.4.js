/*!
  GeoPortal Genie by Stephen Lead
  GeoPortalGenie.com
*/
;var geoPortalGenie={};$(function(){geoPortalGenie.mapModel=null;geoPortalGenie.restModel=new gpGenie.RestModel({mapModel:geoPortalGenie.mapModel,gpServer:configOptions.geoPortalServer,infoMessageContainer:"#infoMessage"});geoPortalGenie.resultsCollection=new gpGenie.ResultsCollection({mapModel:geoPortalGenie.mapModel,restModel:geoPortalGenie.restModel});geoPortalGenie.resultsView=new gpGenie.ResultsView({mapModel:geoPortalGenie.mapModel,restModel:geoPortalGenie.restModel,collection:geoPortalGenie.resultsCollection,resultsContainer:"#searchResults",resultSetTemplate:"results-set-template",resultItemTemplate:"#result-item-template"});geoPortalGenie.restModel.buildCategories();$(document).on("click",".btnZoomTo",function(d){var f=this.getAttribute("data-bbox");if(f!==null&&f!==undefined){f=f.split(",");var b=new esri.geometry.Extent(parseFloat(f[0]),parseFloat(f[1]),parseFloat(f[2]),parseFloat(f[3]),{wkid:4326});var e=esri.geometry.geographicToWebMercator(b);var c=configOptions.zoomFactor||1.5;geoPortalGenie.mapModel.map.setExtent(e.expand(c),true)}});$("#modalResults").modal({show:false,keyboard:true,remote:true});$(document).on("click",".btnThumbnailLink",function(){$(this).button("loading");var b=this.getAttribute("data-img");var d="";var c="<a class='thumb' target='_blank' alt='thumbnail image' title='Click the image to open in a new window' href='"+b+"'><img class='thumb' alt='thumbnail image' src='"+b+"'/></a>";$("#modalTitle").html(d);$("#modalContent").html(c);$("#modalResults").modal("show");$(this).button("reset")});$(document).on("click",".btnDetailsLink",function(){$(this).button("loading");var d=this.getAttribute("data-uuid");var c="csw/discovery?request=GetRecordById&service=CSW&version=2.0.2&elementsetname=full";c+="&id="+d;var b=$.ajax({url:configOptions.proxy,data:{requrl:configOptions.geoportalServer+c},context:this,success:function(f){var e=$.xml2json(f);a(e.Record)},error:function(e){var f="error with Details query";alert(f)}})});function a(b){var d="<h4>"+b.title+"</h4>";$("#modalTitle").html(d);var c;if(b["abstract"]!==null){c="<p class='details abstract'><strong>Abstract:</strong> "+b["abstract"]+"</p>"}$("#modalContent").html(c);$("#modalResults").modal("show");$(".btnDetailsLink").button("reset")}});